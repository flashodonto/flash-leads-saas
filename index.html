<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flash Leads - Login</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ==== SEU LAYOUT ORIGINAL AQUI ==== -->
  <h1>Flash Leads</h1>

  <div class="auth-container">
    <input type="email" id="email" placeholder="Digite seu e-mail" />
    <input type="password" id="password" placeholder="Digite sua senha" />

    <button id="loginButton">Entrar</button>
    <button id="registerButton">Criar Conta</button>
    <button id="googleLoginButton">Entrar com Google</button>

    <div id="message" style="margin-top: 15px; font-weight: bold;"></div>
  </div>

  <!-- Biblioteca Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <!-- ==== SCRIPT DE AUTENTICAÇÃO CORRIGIDO ==== -->
  <script>
    // ===== CONFIGURAÇÃO DO SUPABASE =====
    const SUPABASE_URL = 'https://bjqfxroulfxyqhqopnns.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJqcWZ4cm91bGZ4eXFocW9wbm5zIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyNTkzODEsImV4cCI6MjA2ODgzNTM4MX0.7TRJhwzvbHK23rQP2T6azq6c2mVSDPBgfgwadpZxbjg';

    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    // ===== FUNÇÕES DE AUTENTICAÇÃO =====
    async function handleLogin() {
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const messageDiv = document.getElementById('message');

      if (!email || !password) {
        messageDiv.style.color = "red";
        messageDiv.textContent = "⚠️ Preencha e-mail e senha.";
        return;
      }

      const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });

      if (error) {
        messageDiv.style.color = "red";
        messageDiv.textContent = `❌ Erro: ${error.message}`;
      } else {
        messageDiv.style.color = "green";
        messageDiv.textContent = "✅ Login realizado com sucesso!";
        setTimeout(() => window.location.href = "dashboard.html", 1000);
      }
    }

    async function handleRegister() {
      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();
      const messageDiv = document.getElementById('message');

      if (!email || !password) {
        messageDiv.style.color = "red";
        messageDiv.textContent = "⚠️ Preencha e-mail e senha.";
        return;
      }

      const { data, error } = await supabaseClient.auth.signUp({ email, password });

      if (error) {
        messageDiv.style.color = "red";
        messageDiv.textContent = `❌ Erro: ${error.message}`;
      } else {
        messageDiv.style.color = "green";
        messageDiv.textContent = "✅ Conta criada! Verifique seu e-mail para confirmar.";
      }
    }

    async function loginWithGoogle() {
      const { data, error } = await supabaseClient.auth.signInWithOAuth({
        provider: 'google',
        options: { redirectTo: window.location.origin + "/dashboard.html" }
      });

      if (error) {
        document.getElementById('message').style.color = "red";
        document.getElementById('message').textContent = `❌ Erro: ${error.message}`;
      }
    }

    // ===== CONECTANDO BOTÕES AO CÓDIGO =====
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('loginButton').addEventListener('click', handleLogin);
      document.getElementById('registerButton').addEventListener('click', handleRegister);
      document.getElementById('googleLoginButton').addEventListener('click', loginWithGoogle);
    });
  </script>
</body>
</html>
